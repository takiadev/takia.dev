<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="What are slices in go? What happens under the hood when a slice is modified? How are slice implemented by the compiler? Why can functions modify the elements of a slice but not its length?"><title>Understanding Go slices in depth</title>
<link rel=canonical href=https://takia.dev/go-understanding-slices/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Understanding Go slices in depth"><meta property='og:description' content="What are slices in go? What happens under the hood when a slice is modified? How are slice implemented by the compiler? Why can functions modify the elements of a slice but not its length?"><meta property='og:url' content='https://takia.dev/go-understanding-slices/'><meta property='og:site_name' content='Takia Dev'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2024-08-31T01:00:00+00:00'><meta property='article:modified_time' content='2024-08-31T01:00:00+00:00'><meta name=twitter:title content="Understanding Go slices in depth"><meta name=twitter:description content="What are slices in go? What happens under the hood when a slice is modified? How are slice implemented by the compiler? Why can functions modify the elements of a slice but not its length?"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu16108643881346092861.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üñ•Ô∏è</span></figure><div class=site-meta><h1 class=site-name><a href=/>Takia Dev</a></h1><h2 class=site-description>Coding tips and tutorials.</h2></div></header><ol class=menu-social><li><a href=https://github.com/takiadev target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://youtube.com/@takiadev target=_blank title=YouTube rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" height="64" width="64" viewBox="-46.1 -46.1 553.2 553.2" stroke-width="35" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><g stroke-linecap="round" stroke-linejoin="round" stroke-width="30"><path d="M365.257 67.393H95.744C42.866 67.393.0 110.259.0 163.137v134.728c0 52.878 42.866 95.744 95.744 95.744h269.513c52.878.0 95.744-42.866 95.744-95.744V163.137c0-52.878-42.866-95.744-95.744-95.744zM300.506 237.056l-126.06 60.123c-3.359 1.602-7.239-.847-7.239-4.568V168.607c0-3.774 3.982-6.22 7.348-4.514l126.06 63.881C304.363 229.873 304.298 235.248 300.506 237.056z"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#what-are-slices-a-birds-view>What are slices? A bird&rsquo;s view</a></li><li><a href=#how-are-slices-implemented>How are slices implemented?</a></li><li><a href=#what-happens-when-an-element-is-added-to-a-slice>What happens when an element is added to a slice?</a></li><li><a href=#revealing-the-underlying-struct-implementation>Revealing the underlying struct implementation</a></li><li><a href=#passing-a-slice-as-argument-to-a-function>Passing a slice as argument to a function</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/go/>Go</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/go-understanding-slices/>Understanding Go slices in depth</a></h2><h3 class=article-subtitle>What are slices in go? What happens under the hood when a slice is modified? How are slice implemented by the compiler? Why can functions modify the elements of a slice but not its length?</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 31, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><p>In the Go progamming language, slices are one of the most basic and fundamental data structures. And yet, slices often exhibit strange behaviors: when a slice is passed as argument to a function, some ‚Äì but not all ‚Äì of its data can be modified by the function. In this article, we aim for an in-depth understanding of slices and their behavior by looking at how they are implemented under the hood and how the memory behaves when performing common slice operations.</p><h2 id=what-are-slices-a-birds-view>What are slices? A bird&rsquo;s view</h2><p>At first glance, slices are Go&rsquo;s equivalent for the <code>vector</code> type in C++ or <code>ArrayList</code> in Java. A slice is a dynamic array: it&rsquo;s a container that stores a sequence of elements indexed by integers starting from <code>0</code>. The elements are stored contiguously in memory. Unlike Go arrays, slices can be resized. In the following code snippet, we illustrate common operations on slices:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Create a slice of `rune` with initial length
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>length</span> <span class=p>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>s</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>rune</span><span class=p>,</span> <span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Access the existing elements in the slice
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=sc>&#39;A&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Append a new element to the slice
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>s</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=sc>&#39;B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// print the new length of the slice
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>))</span> <span class=c1>// 6
</span></span></span></code></pre></td></tr></table></div></div><h2 id=how-are-slices-implemented>How are slices implemented?</h2><p>Under the hood, slices are implemented as a <code>struct</code> with three variables: a pointer to the data array, the length of the slice and the capacity of the slice. In this section, we will use valid Go code to shed light on this hidden implementation.</p><p>For instance, the following diagram illustrates the memory layout of a slice <code>s</code> with length <code>5</code> and capacity <code>7</code>. The elements of <code>s</code> are <code>{1, 2, 3, 4, 5}</code>, they are stored contiguously at memory location <code>0xe830</code>.</p><figure><img src=/go-understanding-slices/go-slices-2.svg loading=lazy alt="Memory Layout of a Slice object" title="Memory layout of a slice with length 5 and capacity 7"><figcaption>Memory layout of a slice with length 5 and capacity 7</figcaption></figure><p>Because the slice object only contains a pointer to the data array and not the array itself, the actual size of the array does not impact the size of the slice object. For instance, in the code below we create two slices, one with 0 elements and one with 5 elements, but <code>Sizeof</code> shows that the size of the slice objects is 24 bytes either way.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>s0</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>s1</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>println</span><span class=p>(</span><span class=nx>unsafe</span><span class=p>.</span><span class=nf>Sizeof</span><span class=p>(</span><span class=nx>s0</span><span class=p>))</span> <span class=c1>// 24 bytes
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>println</span><span class=p>(</span><span class=nx>unsafe</span><span class=p>.</span><span class=nf>Sizeof</span><span class=p>(</span><span class=nx>s1</span><span class=p>))</span> <span class=c1>// 24 bytes
</span></span></span></code></pre></td></tr></table></div></div><h2 id=what-happens-when-an-element-is-added-to-a-slice>What happens when an element is added to a slice?</h2><p>Since the elements of a slice are stored contiguously in memory, it can happen that there is not enough space at the end of the slice to add a new element. In this case, a new memory location with more space is allocated to the slice and the elements are copied to the new location. Go keeps track of how much space is reserved for the slice through the <code>capacity</code> value and will roughly double the capacity every time the slice is reallocated.</p><p>The slideshow below illustrates what happens in memory when we append elements to a slice. Use the buttons to move to the next codeline.</p><div class="highlight instantCarousel"><div class=navigationContainer><a class="navigationButton prev">prev</a> <a class="navigationButton next">next</a></div><div class=viewContainer><div class="carouselPane currentPane"><img src=out-1.svg></div><div class=carouselPane><img src=out-2.svg></div><div class=carouselPane><img src=out-4.svg></div><div class=carouselPane><img src=out-5.svg></div><div class=carouselPane><img src=out-6.svg></div><div class=carouselPane><img src=out-7.svg></div><div class=carouselPane><img src=out-8.svg></div><div class=carouselPane><img src=out-9.svg></div><div class=carouselPane><img src=out-10.svg></div><div class=carouselPane><img src=out-11.svg></div><div class=carouselPane><img src=out-12.svg></div><div class=carouselPane><img src=out-13.svg></div><div class=carouselPane><img src=out-14.svg></div><div class=carouselPane><img src=out-15.svg></div><div class=carouselPane><img src=out-16.svg></div><div class=carouselPane><img src=out-17.svg></div><div class=carouselPane><img src=out-18.svg></div><div class=carouselPane><img src=out-19.svg></div><div class=carouselPane><img src=out-20.svg></div><div class=carouselPane><img src=out-21.svg></div><div class=carouselPane><img src=out-22.svg></div></div><div class=navigationContainer><a class="navigationButton prev">prev</a> <a class="navigationButton next">next</a></div></div><script>for(elem of document.querySelectorAll(".instantCarousel .navigationContainer .prev"))elem.addEventListener("click",function(){panes=document.querySelectorAll(".instantCarousel .viewContainer .carouselPane");for(let e=0;e<panes.length;e++){let t=panes[panes.length-1-e];if(t.classList.contains("currentPane")){let n=panes[panes.length-1-(e+1)%panes.length];t.classList.toggle("currentPane"),n.classList.toggle("currentPane");break}}});for(elem of document.querySelectorAll(".instantCarousel .navigationContainer .next"))elem.addEventListener("click",function(){panes=document.querySelectorAll(".instantCarousel .viewContainer .carouselPane");for(let e=0;e<panes.length;e++){let t=panes[e];if(t.classList.contains("currentPane")){let n=panes[(e+1)%panes.length];t.classList.toggle("currentPane"),n.classList.toggle("currentPane");break}}})</script><style>.instantCarousel{background-color:var(--pre-background-color);width:100%;margin:0 auto;padding:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;max-height:100vh}.instantCarousel .viewContainer{overflow:hidden;position:relative;scroll-direction:horizontal;margin:0 auto;flex-grow:1}.instantCarousel .carouselPane{display:none;width:100%}.instantCarousel .carouselPane img{width:100%;max-width:100vw;max-height:80vh}.instantCarousel .currentPane{display:block}.instantCarousel .navigationContainer{text-align:center;margin:0 auto}.instantCarousel .navigationContainer .navigationButton{cursor:pointer;color:var(--accent-color-text);background-color:var(--accent-color);background-color:#0177b8;padding:8px 16px;border-radius:var(--tag-border-radius);display:inline-block;font-size:1.4rem;transition:background-color .5s ease}</style><h2 id=revealing-the-underlying-struct-implementation>Revealing the underlying struct implementation</h2><p>We can use pointer tricks to force the compiler to reveal this hidden struct by reinterpreting the memory address as a struct pointer. This is what the <code>reinterpretAsStruct</code> function does in the code below:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;unsafe&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>SliceStruct</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>array</span>    <span class=o>*</span><span class=p>[</span><span class=mi>100</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=nx>length</span>   <span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=nx>capacity</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>reinterpretAsStruct</span><span class=p>(</span><span class=nx>sliceObject</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=nx>SliceStruct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>pointerToSlice</span> <span class=p>=</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nf>Pointer</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>sliceObject</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>pointerToStruct</span> <span class=p>=</span> <span class=p>(</span><span class=o>*</span><span class=nx>SliceStruct</span><span class=p>)(</span><span class=nx>pointerToSlice</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>structObject</span> <span class=nx>SliceStruct</span> <span class=p>=</span> <span class=o>*</span><span class=nx>pointerToStruct</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>structObject</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>s</span> <span class=p>[]</span><span class=kt>int</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>struct1</span> <span class=nx>SliceStruct</span> <span class=p>=</span> <span class=nf>reinterpretAsStruct</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Underlying array address: %p\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Length: %d\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>s</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Capacity: %d\n&#34;</span><span class=p>,</span> <span class=nb>cap</span><span class=p>(</span><span class=nx>s</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v\n&#34;</span><span class=p>,</span> <span class=nx>struct1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Since the array pointers are the same, every modification in the <code>struct1.array</code> is automatically reflected in the slice <code>s</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Before: s[1] == %d\n&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1>// 0
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>struct1</span><span class=p>.</span><span class=nx>array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;After: s[1] == %d\n&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1>// 42
</span></span></span></code></pre></td></tr></table></div></div><h2 id=passing-a-slice-as-argument-to-a-function>Passing a slice as argument to a function</h2><p>When a slice is passed as argument to a function, the underlying <code>struct</code> object is <em>passed by value</em> to the function, which means that the function receives a <em>copy</em> of the struct object.</p><p>The diagram below illustrates what happens when passing a slice <code>s</code> to the function <code>giveMeSlice</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>giveMeSlice</span><span class=p>(</span><span class=nx>arg</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span> <span class=o>...</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>giveMeSlice</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><figure><img src=/go-understanding-slices/go-slices-3.svg loading=lazy alt="Memory Layout of a Slice passed to a function" title="Slice header is copied, but storage array is the same"><figcaption>Slice header is copied, but storage array is the same</figcaption></figure><p>Even though the function only receives a <em>copy</em> of the array pointer, it can still access the original elements by following the pointer. This explains why a function can modify the elements of a slice.</p><p>But when the function resizes a slice, then only its own <em>copy</em> of the length and capacity variables are updated and this update is not propagated to the original slice object.</p><p>The code below illustrates these considerations:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>giveMeSlice</span><span class=p>(</span><span class=nx>arg</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;[in function] Slice address: %p\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>arg</span><span class=p>)</span>    <span class=c1>// 0x8060
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;[in function] Array address: %p\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>arg</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=c1>// 0xe180
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>s</span> <span class=p>[]</span><span class=kt>int</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Slice address: %p\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>s</span><span class=p>)</span>     <span class=c1>// 0x8030
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Array address: %p\n&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1>// 0xe180
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>giveMeSlice</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>¬© 2020-2025 Takia.Dev</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Aug 31, 2024 01:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/go-exercise-goroutines-1/><div class=article-details><h2 class=article-title>Using goroutines to call 3 webservices in Go</h2></div></a></article><article><a href=/go-convert-functions-to-interfaces/><div class=article-details><h2 class=article-title>Convert Functions to Interfaces and vice versa in Go</h2></div></a></article><article><a href=/go-cheatsheet/><div class=article-details><h2 class=article-title>Go cheatsheet</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=takiadev/comments issue-term=url crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 Takia Dev</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>